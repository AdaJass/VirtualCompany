# 概述
* 主要思想
    >将区块链技术与公司流程结合
* 目标
    >构建虚拟公司。公司可以抽象为将特定的人聚合在一起以既定的目标和规则做事，并实现盈利的组织。虚拟公司也可以实现这一目的，但是虚拟公司不需要以实体存在，也不需要把人在物理上聚集在一起。简单说就是利用财务、任务分配等一系列自动化软件使得虚拟公司的人可以完全的远程办公。

## 介绍&启发
我们最初的目的，是想做一个能实现虚拟公司的工具。虽然这套系统或许最终可能会走的更远。当前，远程办公技术已经有很多具体实践。不少工作可以在家里点点鼠标敲敲键盘就能完成。但是，目前的协同办公系统（例如TodoNow）一般着眼于工作安排和工作进展展示，没能与公司的资金链结合，不能操控资金，也就难以实现更多的自动化。虚拟货币体系，又由于没能在现实产生实际的效益，一直褒贬不一。这两个，很互补也很适合结合在一起。

当然，不能只是简单的照搬粘合，还需要对它们进行改造。当前的数字货币，以分布式区块以及算法实现了一个独立于世界范围内的实体组织的*可信任*金融体系。缺点就是为了这个*可信任*而太耗费资源和损耗交易吞吐量。虚拟货币还有一个问题就是发新币的机制脱离了法币体系，参与者的收获往往是靠计算机算力和参与者参与的早晚决定的。这样的游戏规则很难让那些接触晚的人接受，这是不公平的。这些都是我们要解决的问题。

## 关键字
本节介绍对应着整套系统各个*关键部分*的一些关键字。通过关键字，可以简单了解整套系统实现了那些功能以及如何实现。

* 数字货币
    >为了方便叙述，我将这一套虚拟币取名为Obe(源于globe).Obe 将基于 <a href="https://github.com/eosio/eos">Eos</a> 开发，但是会去掉Pos机制。Obe的节点一般都是非匿名的，超级节点由现实世界中的可信机构维护， 超级节点将会通过配置或者类似全民公投的选举产生，超级节点一般只有3~4个。超级节点存在的意义有两个，一个是使系统成为可信系统；新Obe的产生是通过人们用法币与超级节点兑换实现的，所以超级节点还需要处理与法币相关的工作，如制定兑换比例。

* 账户
    >整套系统将维护一个账户体系，数字货币系统也需要与账户体系结合。一个账号可以有多个Obe钱包，每个钱包也必定要与账号绑定。每个账号指向了现实中具体的人或组织。账号体系将会维护一些个人数据以支持必要的计算，比如个人的身份、年龄、爱好、能力等等

    >维护超级节点的账号是超级账号。

* 
* Kickstarter
    >就类似于 *kickstarter*网站，是想法和金钱碰面的地方. 假设一个想法2突然获得了某个投资人的赏识，他们就可以组建一个虚拟公司了。
     
* 工作流
    >在研究工作流程时我们发现，工作流程的每个节点之间是相似的，并且每个节点又与整体是相似的。举个现实世界的例子，一个餐馆的主流程可能是这样的：`吸引顾客-->接收顾客点单-->做菜-->上菜...` 对于每个流程节点，都可以再细分为几个子流程。例如做菜的流程，就可以分为：洗菜、切菜、炒菜、装盘... 这就像是一种递归结构，或者说像数学上的分形。

    >更具体的例子：比如boss设定了两条公司主线，生产商品 和 销售。那么这就是一个完整的业务流程，但是这个粒度太粗了。boss制定了这两条线，分别分发给生产主管和销售主管负责，而boss只对这两个主管的工作进行监督。
    
    >生产主管拿到任务，就把任务再细分一层分为：采购原料、生产产品、质量监测 等，然后再安排对应的负责人。这然后采购主管接到任务再进行细分……这样，公司的整个流程就和公司的组织架构结合起来了。当流程分到不能再细分的时候，就是真正完成工作的普通员工。当然，普通员工完成工作也是一步一步的进行的，这也是流程.这一整个的高度相似性的结构,类似于数学上的分形。
    
    >具体流程的制定，就只由分管领导负责。这样，公司高层只负责粗粒度的东西，不把控具体细节，一方面保证了整体的动态性和适应性，而各级的组织可以根据自己所长使得整体结构最优。从宏观上看，你只是指定一个目标，并不需要关心具体怎么实现。但是人们自发的合作起来，构建了一个动态的、高效的、可能是你意料之外的流程结构。而这一套流程结构，就会具体的告诉每个人什么时候做什么，高效的合作起来……这很美

* 虚拟公司
    >工作流基本定义了一个虚拟公司的骨架，但虚拟公司还需要其它部分。它们是钱、权限控制，组织结构，账户管理，工作流设置等为工作流提供服务的部分。

    >当一个虚拟公司被设定时，一个新的账户将被绑定到这个虚拟公司，这个账户将在几个投资人账户的监管下完成对公司的一些设置。当然，Obe也会被划归这个账户名下保管，我们把这个账户称为公司的管理员账户。管理员账户将会设定公司的工作流，当然，是很粗略的那种，有点类似于战略，需要被下一级的主管人进一步对一些流程节点进行分解。虽然管理员有权将公司的整体的工作流都设置完成，但这会很复杂而且对管理员来说也太不方便了，而我们的目的之一就是要让开公司变得方便简单。

    >在工作流当中，我们把有特殊功能的账户称为角色，也就是这个账户在流程中担任了某种角色。一个角色只能操作他所在的层级的流程，而且不该染指他所负责的流程的下级流程（它应该只负责拆分好任务）。很显然的，角色正好和传统的公司组织架构对应起来了。不同的是，现实中的领导很大的一部分工作是管人，但对于虚拟公司来说，管人是不再必要的，领导的主要工作是判断下属的工作是否合格，所以就需要领导有相关的工作经验和判断力。 现实中，整个公司的流程是复杂的，但对于每个角色所负责的那部分来说，又是简单的。你只需要定义好你所扮演的角色该定义的那部分流程就好了。

    >高层的角色往往能对公司产生决定性的影响，所以不建议使用在现实中不熟悉的账户管理公司高层。在实际操作中，高层“领导”可能需要经常性的开会讨论公司的结构调整和任务拆分，所以高层可能需要工作在一起。

* 工作
    >有了虚拟公司，当然需要有人来找工作。如果你有一个账户，那么就可以在这套系统上找工作了。工资将以Obe支付，当然可以直接和平台兑换成法币。理论上，每个账户都能在平台上发布工作，一份工作包含雇佣者、审核人和工作者这三个参与主体。雇佣者发放任务，支付工资给工作者和审核人。对于虚拟公司来说，审核人正好和公司的领导层对应，也有可能审核人与任务发布者是同一身份。当三方任意两方发生分歧时，可以向系统发起申述，申述将对败诉者做出惩罚并记录在案。
    
    >出于工作者的忠诚度考虑，虚拟公司与工作者之间可以制定复杂的自动化的“智能合约”约定，薪水的构成也可以变得复杂多样，这是一个开放性的问题。总之，我们可以做到保证双方的权益。

## 整体架构

以下每个主题代表一个独立的服务。
### 虚拟货币
采用C++语言，基于EOS开发。

### 提供的接口
* 新建钱包 （内部接口）
* 钱包查询 （内部接口）
* 转账     （内部接口）
* 转账历史 （内部接口）
* 

### 账户管理
#### 架构设计
用nodejs开发，对于计算量大的部分可以采用内嵌C++的方式。账户管理服务只运行在有限的几个超级节点，几个节点之间保持数据同步。为了负载更大量的请求，会根据账号对服务进行拆分。一个轻量的服务提供类似网关的功能，将请求转发到该账号对应的服务。

以下通过例子分析查询和更新请求的处理过程：
查询：客户端向某个超级节点的账户服务发起查询请求-->客户端网关服务根据账号计算出处理节点，将服务转发给局域网内某个处理节点-->处理节点处理数据并转发给网关-->网关响应用户请求。

更新：客户端向某个超级节点的账户服务发起查询请求-->客户端网关服务根据账号计算出处理节点，将服务转发给局域网内某个处理节点-->处理节点处理数据并转发给网关， 处理节点将更新数据与其它超级节点同步-->网关响应用户请求。

可见，更新过程比查询过程多一个与其它超级节点同步的步骤。

#### 数据结构
账户主要维护一些数据结构，它们是：
主表：
```
{
    昵称
    姓名
    账号： 两个字母+6位数字 （能服务6亿用户，多于这个就需要扩展成7位数字了)
    钱包地址：
    密钥：
}

好友关系表：
{

}
操作日志表：
{

}

任职公司信息表：
{
    公司名：
    主账号id:
    担任角色：
    权限：
    工薪约定：
    劳务合约id：
}

劳务历史：
{

}

纠纷历史：
{

}

```
#### 提供的接口
* 登录接口      （外部接口）
* 注册接口      （外部接口）
* 好友关系查询  （外部接口）
* 能力可信度查询（外部接口）
* 公司角色查询  （外部接口）
* 新建钱包      （外部接口）
* 钱包查询      （外部接口）
* 转账          （外部接口）
* 转账历史      （外部接口）

### 虚拟公司
nodejs
#### 流程流转
1. 流程的开始： 开始条件，发起条件，，例如某个情况产生
2. 流程的执行方式： 多条并行、单条串行
3. 流程的控制： 描述执行的节点或有审批人参与的节点，控制流程走向
5. 流程结束并输出：达到某种条件结束，输出类型全预判好，接受者
6. 流程结果接收与反馈： 接受者接收输出，并对流程进行可能需要的反馈
7. 流程绩效评价，可能是多方参与的一个评价，作为报酬的主要衡量指标

#### 流程参与者
1. 流程执行者： 流程的参与者，发起人也算是执行者。
2. 节点审批人
3. 接收者  接收对象，不一定是人
4. 责任人， 责任人可能是执行者或者审批人中的一员，有可能不是；但该人对整个流程负责。

#### 流程资源（除人以外的部分）
1. 内部直接资源
2. 内部创造的资源
3. 外部资源

#### 公司类

##### 组织树
就是一个组织架构的树状结构，主要用于描述职位信息，涵盖公司所有成员。

##### 流程类
流程流转、流程参与者、流程资源 这三个部分其实基本抽象了所有的流程的基本结构。按面向对象程序设计的思路，只要设计好一个比较全面的类，就能涵盖一整套流程体系。
在一个流程里，最小的单元应该是一个个的节点，那么这些节点都对应着该类的对象。这个对象可能被其它对象包含着，也可能本身就是一个完整的流程。一般在树状结构的关系里，父节点和子叶节点可能由不同的结构（类）描述，这里它们将有同一个类描述。

最简单的一个结构，它的初始化方式和它们之间的组织方式将构成和描述无限复杂的整个公司的流程执行过程。或许一个公司就1~2个主流程，但主流程有细微结构。整体类似于分形结构。

#### 提供的接口
* 公司注册
* 公司配置变更
* 公司流程设定：流程流转图，流程节点负责人
* 流程节点运转时信息生成

很多内部执行过程可能对用户隐藏。

### 消息服务
C++
消息推送与简单的聊天信息服务器

### 人事服务
当用户把界面切换到求职者界面时，将用到这个服务。一方面，公司流程在设定时，如果没有找到合适的指定人，就可以在人事服务里自动发布职位信息；另一方面，公司可以发起人事流程，也会发布职位信息。
给求职者系统会提供合适的职位信息列表，给公司提供合适的人选列表

### 主流程
提供对外暴露的所有接口，类似于网关，不使用微服务框架，所以要写一个主程序提供http协议接口。其余接口通过rpc或长连接与该服务通信

前端：
登录人可以选择求职者模式 与 公司员工模式。员工模式因为有多种职位，所以会有些复杂。